(function(e){function n(e,n){i(e,n,"left","width")}function t(e,n){i(e,n,"top","height")}function i(n,t,i,h){function p(e,a){return function(){t.cycle?(x=e(x,z-1),0>x&&(x=z-1),x>z-1&&(x=0)):x=r(e(x,z-1),0,z-1);var s={};s[i]=-100*x+"%",m.animate(s,t.delay,a),g(x,t.buttonClass),n.trigger("updateSlide",[x])}}function g(e,i){u(y,e,i),t.cycle||d(n,e,z),f(C,e),t.resize&&b.animate({height:C.eq(e).height()||void 0},t.resizeDelay,function(){n.parents(".slides").siblings(".navi").find(".selected."+i+":first").trigger("click")})}var b=e(".slides:first",n),C=b.children().append(e("<div>")),m=e("<div>").append(C).appendTo(b),y=e("."+t.naviClass+":last",n),z=C.length,x=0;s(b,h,m,i,C),l(C,y,p,t.autoNavi,t.buttonClass),o(n,m,p),c(n,m,p,t.autoPlay,t.still),t.resize&&a(b,C,x),g(x,t.buttonClass),v(n),e(window).resize(function(){a(b,C,x)})}function a(e,n,t){e.height(n.eq(t).height()||void 0)}function r(e,n,t){return Math.min(Math.max(e,n),t)}function s(n,t,i,a,r){n.css("overflow","hidden");var s={position:"relative"};s[t]=100*r.length+"%",s[a]="0%",i.css(s);var l={display:"top"==a?"auto":"inline-block","vertical-align":"top"},o=100/r.length;l[t]=parseInt(o,10)+"%";var c=(o-parseInt(o,10))/2+"%";"width"==t?(l["margin-left"]=c,l["margin-right"]=c):(l["margin-top"]=c,l["margin-bottom"]=c),r.each(function(n,t){e(t).css(l).addClass("slide")})}function l(n,t,i,a,r){n.each(function(n,s){var l=e("<a>",{href:"#"}).css("display","inline").bind("click",function(e){e.preventDefault(),i(function(){return n})()}).appendTo(t).addClass("title "+r);a?e(s).clone().appendTo(l):l.text(e(s).attr("title")||n+1)})}function o(e,n,t){function i(i,a){e.find(i).bind("click",function(e){e.preventDefault(),n.clearQueue(),t(a)()})}i(".prev",function(n){var t=n-1;return e.trigger("previousSlide",[t]),t}),i(".next",function(n){var t=n+1;return e.trigger("nextSlide",[t]),t}),i(".first",function(){var n=0;return e.trigger("firstSlide",[n]),n}),i(".last",function(n,t){var i=t;return e.trigger("lastSlide",[i]),i})}function c(n,t,i,a,r){var s=i(function(e,n){return e==n?0:e+1},function(){e(this).delay(r).queue(function(){s(),e(this).dequeue()})});n.find(".play").bind("click",function(e){e.preventDefault(),s()}),n.find(".stop").bind("click",function(e){e.preventDefault(),t.clearQueue()})}function u(e,n,t){var i=e.find(".title."+t);i.removeClass("selected"),i.eq(n).addClass("selected")}function d(e,n,t){var i=e.find(".first,.prev"),a=e.find(".last,.next");0===n?i.addClass("disabled"):i.removeClass("disabled"),n==t-1?a.addClass("disabled"):a.removeClass("disabled")}function f(n,t){n.each(function(n,i){e(i).removeClass("prev current next"),n==t-1&&e(i).addClass("prev"),n==t&&e(i).addClass("current"),n==t+1&&e(i).addClass("next")})}function v(n){return n.each(function(){e(this).attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"}).each(function(){this.onselectstart=function(){return!1}})})}e.fn.caro=function(i){return this.each(function(){var a=e(this),r=e.extend({dir:"horizontal",delay:300,still:1e3,autoPlay:!1,naviClass:"navi",buttonClass:"button",autoNavi:!1,cycle:!1,resize:!0,resizeDelay:300},i),s="horizontal"==r.dir?n:t;s(a,r)})}})(jQuery);